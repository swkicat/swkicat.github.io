<!DOCTYPE html><html lang="kr"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.25.7"/><meta data-react-helmet="true" property="og:title" content="개발자 스티치 | item1-가변성을 제한하라"/><meta data-react-helmet="true" property="og:site_title" content="개발자 스티치 | item1-가변성을 제한하라"/><meta data-react-helmet="true" name="description" content="본 책에 존재하는 코드는 BankAccount에는 계좌에 돈이 얼마나 있는지 나타내는 상태가 있다. 위 코드가 작동 동작에 대해서는 문제가 없지만, 상태를 적절하게 관리하기 위해서는 어려움이 존재한다. 상태를 관리하기 어려운 이유 프로그램을 이해하고 디버그하는데 어려움이 존재한다. 가변성(mutability) 있으면, 코드의 실행을 추적하기 어려움이 존재한다. 멀티스레드 프로그램 상황에서 적절한 동기화가 필요하다. 테스트가 어렵다. 모든 상태를 테스트해야하기에 변경이 많아질수록 더 많은 조합을 테스트해야 한다. 상태 변경이 일어나면, 변경을 다른 부분에 알려야 한다. 정렬해야 하는 리스트에 새로운 가변 값이 추가되면, 리스트를 다시 정렬하라고 알려줘야 한다. 가변성은 생각보다 단점이 많아서 완전하게 제한하는 프로그래밍 언어가 있다. 가변성은 시스템의 상태를 나타내기 위한 중요한 방법이다. 하지만 변경이 일어나야 하는 부분은 신중, 확실하게 결정하고 사용해야 한다. 코틀린에서 가변성…"/><meta data-react-helmet="true" property="og:description" content="본 책에 존재하는 코드는 BankAccount에는 계좌에 돈이 얼마나 있는지 나타내는 상태가 있다. 위 코드가 작동 동작에 대해서는 문제가 없지만, 상태를 적절하게 관리하기 위해서는 어려움이 존재한다. 상태를 관리하기 어려운 이유 프로그램을 이해하고 디버그하는데 어려움이 존재한다. 가변성(mutability) 있으면, 코드의 실행을 추적하기 어려움이 존재한다. 멀티스레드 프로그램 상황에서 적절한 동기화가 필요하다. 테스트가 어렵다. 모든 상태를 테스트해야하기에 변경이 많아질수록 더 많은 조합을 테스트해야 한다. 상태 변경이 일어나면, 변경을 다른 부분에 알려야 한다. 정렬해야 하는 리스트에 새로운 가변 값이 추가되면, 리스트를 다시 정렬하라고 알려줘야 한다. 가변성은 생각보다 단점이 많아서 완전하게 제한하는 프로그래밍 언어가 있다. 가변성은 시스템의 상태를 나타내기 위한 중요한 방법이다. 하지만 변경이 일어나야 하는 부분은 신중, 확실하게 결정하고 사용해야 한다. 코틀린에서 가변성…"/><meta data-react-helmet="true" property="og:author" content="swkicat"/><meta data-react-helmet="true" property="og:author" content="swkicat"/><meta data-react-helmet="true" property="og:image" content="/og-image.png"/><meta data-react-helmet="true" property="og:type" content="website"/><style data-href="/styles.ec715300629f179678b0.css" data-identity="gatsby-global-css">@import url(https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Noto+Sans+KR&display=swap);code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{border:0;font-size:100%;font:inherit;margin:0;padding:0;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:"";content:none}table{border-collapse:collapse;border-spacing:0}a{outline:none;text-decoration:none}.markdown .octicon{fill:currentColor;display:inline-block;vertical-align:text-bottom}.markdown .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown .anchor:focus{outline:none}.markdown h1 .octicon-link,.markdown h2 .octicon-link,.markdown h3 .octicon-link,.markdown h4 .octicon-link,.markdown h5 .octicon-link,.markdown h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown h1:hover .anchor,.markdown h2:hover .anchor,.markdown h3:hover .anchor,.markdown h4:hover .anchor,.markdown h5:hover .anchor,.markdown h6:hover .anchor{text-decoration:none}.markdown h1:hover .anchor .octicon-link,.markdown h2:hover .anchor .octicon-link,.markdown h3:hover .anchor .octicon-link,.markdown h4:hover .anchor .octicon-link,.markdown h5:hover .anchor .octicon-link,.markdown h6:hover .anchor .octicon-link{visibility:visible}.markdown h1:hover .anchor .octicon-link:before,.markdown h2:hover .anchor .octicon-link:before,.markdown h3:hover .anchor .octicon-link:before,.markdown h4:hover .anchor .octicon-link:before,.markdown h5:hover .anchor .octicon-link:before,.markdown h6:hover .anchor .octicon-link:before{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true' viewBox='0 0 16 16'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E");content:" ";display:inline-block;height:16px;width:16px}.markdown{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;word-wrap:break-word;font-size:16px;font-weight:500;line-height:1.5}.markdown details{display:block}.markdown summary{display:list-item}.markdown a{background-color:initial}.markdown a:active,.markdown a:hover{outline-width:0}.markdown strong{font-weight:inherit;font-weight:bolder}.markdown h1{margin:.67em 0}.markdown img{border-style:none}.markdown code,.markdown kbd,.markdown pre{font-family:monospace,monospace;font-size:1em}.markdown hr{box-sizing:initial;overflow:visible}.markdown input{font:inherit;margin:0;overflow:visible}.markdown [type=checkbox]{box-sizing:border-box;padding:0}.markdown *{box-sizing:border-box}.markdown input{font-family:inherit;font-size:inherit;line-height:inherit}.markdown a{border-bottom:.05em solid;border-color:var(--link-text-color);color:var(--link-text-color);text-decoration:none}.markdown a.anchor{border-bottom:none}.markdown strong{font-weight:700}.markdown hr{background:transparent;border-bottom:1px solid var(--markdown-blockquote-border-color);height:0;margin:15px 0;overflow:hidden}.markdown hr:after,.markdown hr:before{content:"";display:table}.markdown hr:after{clear:both}.markdown table{border-collapse:collapse;border-spacing:0}.markdown td,.markdown th{padding:0}.markdown details summary{cursor:pointer}.markdown h1,.markdown h2,.markdown h3,.markdown h4,.markdown h5,.markdown h6{margin-bottom:0;margin-top:0}.markdown h1{font-size:32px}.markdown h1,.markdown h2{font-weight:600}.markdown h2{font-size:24px}.markdown h3{font-size:20px}.markdown h3,.markdown h4{font-weight:600}.markdown h4{font-size:16px}.markdown h5{font-size:14px}.markdown h5,.markdown h6{font-weight:600}.markdown h6{font-size:12px}.markdown p{line-height:200%;margin-bottom:10px;margin-top:0}.markdown blockquote{margin:0}.markdown ol,.markdown ul{margin-bottom:0;margin-top:0;padding-left:0}.markdown ol ol,.markdown ul ol{list-style-type:lower-roman}.markdown ol ol ol,.markdown ol ul ol,.markdown ul ol ol,.markdown ul ul ol{list-style-type:lower-alpha}.markdown dd{margin-left:0}.markdown code,.markdown pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}.markdown code.language-text{border-radius:3px;font-size:85%;padding:.2em .4em}.markdown :not(pre)>code.language-text{background:hsla(44,6%,50%,.15);color:#eb5757;overflow-wrap:break-word}.markdown pre{margin-bottom:0;margin-top:0}.markdown input::-webkit-inner-spin-button,.markdown input::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}.markdown :checked+.radio-label{border-color:#0366d6;position:relative;z-index:1}.markdown .border{border:1px solid var(--markdown-border-color)!important}.markdown .border-0{border:0!important}.markdown .border-bottom{border-bottom:1px solid var(--markdown-border-color)!important}.markdown .rounded-1{border-radius:3px!important}.markdown .bg-white{background-color:transparent!important}.markdown .bg-gray-light{background-color:#fafbfc!important}.markdown .text-gray-light{color:#6a737d!important}.markdown .pl-3,.markdown .px-3{padding-left:16px!important}.markdown .px-3{padding-right:16px!important}.markdown .f6{font-size:12px!important}.markdown .lh-condensed{line-height:1.25!important}.markdown .text-bold{font-weight:600!important}.markdown .pl-c{color:#6a737d}.markdown .pl-c1,.markdown .pl-s .pl-v{color:#005cc5}.markdown .pl-e,.markdown .pl-en{color:#6f42c1}.markdown .pl-s .pl-s1,.markdown .pl-smi{color:#24292e}.markdown .pl-ent{color:#22863a}.markdown .pl-k{color:#d73a49}.markdown .pl-pds,.markdown .pl-s,.markdown .pl-s .pl-pse .pl-s1,.markdown .pl-sr,.markdown .pl-sr .pl-cce,.markdown .pl-sr .pl-sra,.markdown .pl-sr .pl-sre{color:#032f62}.markdown .pl-smw,.markdown .pl-v{color:#e36209}.markdown .pl-bu{color:#b31d28}.markdown .pl-ii{background-color:#b31d28;color:#fafbfc}.markdown .pl-c2{background-color:#d73a49;color:#fafbfc}.markdown .pl-c2:before{content:"^M"}.markdown .pl-sr .pl-cce{color:#22863a;font-weight:700}.markdown .pl-ml{color:#735c0f}.markdown .pl-mh,.markdown .pl-mh .pl-en,.markdown .pl-ms{color:#005cc5;font-weight:700}.markdown .pl-mi{color:#24292e;font-style:italic}.markdown .pl-mb{color:#24292e;font-weight:700}.markdown .pl-md{background-color:#ffeef0;color:#b31d28}.markdown .pl-mi1{background-color:#f0fff4;color:#22863a}.markdown .pl-mc{background-color:#ffebda;color:#e36209}.markdown .pl-mi2{background-color:#005cc5;color:#f6f8fa}.markdown .pl-mdr{color:#6f42c1;font-weight:700}.markdown .pl-ba{color:#586069}.markdown .pl-sg{color:#959da5}.markdown .pl-corl{color:#032f62;text-decoration:underline}.markdown .mb-0{margin-bottom:0!important}.markdown .my-2{margin-bottom:8px!important;margin-top:8px!important}.markdown .pl-0{padding-left:0!important}.markdown .py-0{padding-bottom:0!important;padding-top:0!important}.markdown .pl-1{padding-left:4px!important}.markdown .pl-2{padding-left:8px!important}.markdown .py-2{padding-bottom:8px!important;padding-top:8px!important}.markdown .pl-3{padding-left:16px!important}.markdown .pl-4{padding-left:24px!important}.markdown .pl-5{padding-left:32px!important}.markdown .pl-6{padding-left:40px!important}.markdown .pl-7{padding-left:48px!important}.markdown .pl-8{padding-left:64px!important}.markdown .pl-9{padding-left:80px!important}.markdown .pl-10{padding-left:96px!important}.markdown .pl-11{padding-left:112px!important}.markdown .pl-12{padding-left:128px!important}.markdown hr{border-bottom-color:#eee}.markdown kbd{background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da;color:#444d56;display:inline-block;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;padding:3px 5px;vertical-align:middle}.markdown:after,.markdown:before{content:"";display:table}.markdown:after{clear:both}.markdown>:first-of-type{margin-top:0!important}.markdown>:last-child{margin-bottom:0!important}.markdown a:not([href]){color:inherit;text-decoration:none}.markdown blockquote,.markdown details,.markdown dl,.markdown ol,.markdown p,.markdown pre,.markdown table,.markdown ul{margin-bottom:16px;margin-top:0}.markdown hr{background-color:var(--markdown-border-color);border:0;height:1px;margin:24px 0;padding:0}.markdown blockquote{border-left:2px solid var(--markdown-blockquote-border-color);color:#6a737d;padding:0 1em}.markdown blockquote>:first-of-type{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown em{font-style:italic}.markdown h1,.markdown h2,.markdown h3,.markdown h4,.markdown h5,.markdown h6{font-weight:600;line-height:1.25;margin-bottom:16px;margin-top:24px}.markdown h1{font-size:2em}.markdown h2{font-size:1.5em}.markdown h3{font-size:1.25em}.markdown h4{font-size:1em}.markdown h5{font-size:.875em}.markdown h6{color:#6a737d;font-size:.85em}.markdown ol,.markdown ul{padding-left:2em}.markdown ol ol,.markdown ol ul,.markdown ul ol,.markdown ul ul{margin-bottom:0;margin-top:0}.markdown ol{list-style-type:decimal}.markdown ul{list-style-type:disc}.markdown li{word-wrap:break-all;display:list-item;line-height:200%;text-align:-webkit-match-parent}.markdown li>p{margin-top:16px}.markdown li+li{margin-top:.25em}.markdown dl{padding:0}.markdown dl dt{font-size:1em;font-style:italic;font-weight:600;margin-top:16px;padding:0}.markdown dl dd{margin-bottom:16px;padding:0 16px}.markdown table{display:block;overflow:auto;width:100%}.markdown table th{font-weight:600}.markdown table td,.markdown table th{border:1px solid var(--markdown-table-border-color);padding:6px 13px}.markdown table tr{border-top:1px solid var(--markdown-table-border-color)}.markdown table tr:nth-child(2n){background-color:var(--markdown-table-even-cell-background-color)}.markdown img{background-color:transparent;box-sizing:initial;display:block;margin:0 auto;max-width:100%}.markdown img[align=right]{padding-left:20px}.markdown img[align=left]{padding-right:20px}.markdown code{background-color:rgba(27,31,35,.05);border-radius:3px;font-size:85%;margin:0;padding:.2em .4em}.markdown pre{word-wrap:normal}.markdown pre>code{background:transparent;border:0;font-size:100%;margin:0;padding:0;white-space:pre;word-break:normal}.markdown .highlight{margin-bottom:16px}.markdown .highlight pre{margin-bottom:0;word-break:normal}.markdown .highlight pre,.markdown pre{background-color:#f6f8fa;border-radius:3px;font-size:85%;line-height:1.45;overflow:auto;padding:16px}.markdown pre code{word-wrap:normal;background-color:initial;border:0;display:inline;line-height:inherit;margin:0;max-width:auto;overflow:visible;padding:0}.markdown .commit-tease-sha{color:#444d56;display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%}.markdown .full-commit .btn-outline:not(:disabled):hover{border-color:#005cc5;color:#005cc5}.markdown .blob-wrapper{overflow-x:auto;overflow-y:hidden}.markdown .blob-wrapper-embedded{max-height:240px;overflow-y:auto}.markdown .blob-num{color:rgba(27,31,35,.3);cursor:pointer;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;min-width:50px;padding-left:10px;padding-right:10px;text-align:right;-webkit-user-select:none;user-select:none;vertical-align:top;white-space:nowrap;width:1%}.markdown .blob-num:hover{color:rgba(27,31,35,.6)}.markdown .blob-num:before{content:attr(data-line-number)}.markdown .blob-code{line-height:20px;padding-left:10px;padding-right:10px;position:relative;vertical-align:top}.markdown .blob-code-inner{word-wrap:normal;color:#24292e;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;overflow:visible;white-space:pre}.markdown .pl-token.active,.markdown .pl-token:hover{background:#ffea7f;cursor:pointer}.markdown .tab-size[data-tab-size="1"]{-o-tab-size:1;tab-size:1}.markdown .tab-size[data-tab-size="2"]{-o-tab-size:2;tab-size:2}.markdown .tab-size[data-tab-size="3"]{-o-tab-size:3;tab-size:3}.markdown .tab-size[data-tab-size="4"]{-o-tab-size:4;tab-size:4}.markdown .tab-size[data-tab-size="5"]{-o-tab-size:5;tab-size:5}.markdown .tab-size[data-tab-size="6"]{-o-tab-size:6;tab-size:6}.markdown .tab-size[data-tab-size="7"]{-o-tab-size:7;tab-size:7}.markdown .tab-size[data-tab-size="8"]{-o-tab-size:8;tab-size:8}.markdown .tab-size[data-tab-size="9"]{-o-tab-size:9;tab-size:9}.markdown .tab-size[data-tab-size="10"]{-o-tab-size:10;tab-size:10}.markdown .tab-size[data-tab-size="11"]{-o-tab-size:11;tab-size:11}.markdown .tab-size[data-tab-size="12"]{-o-tab-size:12;tab-size:12}.markdown .task-list-item{list-style-type:none}.markdown .task-list-item+.task-list-item{margin-top:3px}.markdown .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}.markdown .table-of-contents{align-items:flex-start;display:flex;flex-direction:column;justify-content:center;overflow-y:scroll;position:fixed;right:0;top:75px;width:340px}@media(max-width:1400px){.markdown .table-of-contents{display:none}}.markdown .table-of-contents ul{cursor:pointer;list-style-type:none}.markdown .table-of-contents ul li a{border-bottom:none;color:#6a737d;font-size:14px;height:30px}.markdown .table-of-contents ul p{margin:0}.markdown .gatsby-resp-image-wrapper{display:flex!important;justify-content:center!important;max-height:560px!important;width:100%!important}.markdown .gatsby-resp-image-wrapper img{height:auto!important;max-height:560px!important;max-width:100%!important;position:relative!important;width:auto!important}.markdown .gatsby-resp-image-wrapper+em{color:#6a737d;display:block;font-size:15px;font-style:italic;text-align:center}@font-face{font-family:GmarketSansLight;font-style:normal;src:url(https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/GmarketSansLight.woff) format("woff")}@font-face{font-family:GmarketSansMedium;font-style:normal;src:url(https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/GmarketSansMedium.woff) format("woff")}@font-face{font-family:GmarketSansBold;font-style:normal;src:url(https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/GmarketSansBold.woff) format("woff")}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><title data-react-helmet="true">개발자 스티치 | item1-가변성을 제한하라</title><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3HJ4DE7X8R"></script><script>
    window.GATSBY_GTAG_PLUGIN_GA_TRACKING_ID = (
      'G-3HJ4DE7X8R'
    );
    window.GATSBY_GTAG_PLUGIN_ANONYMIZE = false;

    var options = {
      send_page_view: false
    };
    if (false) {
      options.anonymize_ip = true;
    }

    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    window.gtag = gtag;
    gtag('js', new Date());
    gtag('config', 'G-3HJ4DE7X8R', options);
  </script><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="icon" href="/favicon-32x32.png?v=12a28fe749aa82d4d5fb552877e7bc9f" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=12a28fe749aa82d4d5fb552877e7bc9f"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=12a28fe749aa82d4d5fb552877e7bc9f"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=12a28fe749aa82d4d5fb552877e7bc9f"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=12a28fe749aa82d4d5fb552877e7bc9f"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=12a28fe749aa82d4d5fb552877e7bc9f"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=12a28fe749aa82d4d5fb552877e7bc9f"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=12a28fe749aa82d4d5fb552877e7bc9f"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=12a28fe749aa82d4d5fb552877e7bc9f"/><link rel="preload" href="https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/GmarketSansLight.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/GmarketSansMedium.woff" as="font" type="font/woff" crossorigin="anonymous"/><link rel="preload" href="https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/GmarketSansBold.woff" as="font" type="font/woff" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css-global q7z4oc">*{box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;}html{font-family:'GmarketSansMedium';width:100%;height:100%;overflow-y:scroll;font-size:14px;color:#0F1010;background-color:#F7F8FA;}html a{color:#0F1010;-webkit-text-decoration:none;text-decoration:none;}body{-ms-overflow-style:none;scrollbar-width:none;}::-webkit-scrollbar{display:none;}.pc-only{display:block;}@media screen and (max-width: 768px){.pc-only{display:none;}}.mobile-only{display:none;}@media screen and (max-width: 768px){.mobile-only{display:block;}}.markdown{font-family:'Noto Sans KR',sans-serif;}.scroll-locked{overflow:hidden;}</style><style data-emotion="css 1im0r96">.css-1im0r96{overflow-y:scroll;}</style><div class="css-1im0r96 e1oc8ext2"><style data-emotion="css do88k5">.css-do88k5{cursor:pointer;position:fixed;z-index:1000;top:0;right:0;background-color:#3C3D40;border-radius:50%;width:50px;height:50px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;top:20px;right:20px;}.css-do88k5 .theme-icon{color:#FFFFFF;width:20px;height:20px;}@media screen and (max-width: 768px){.css-do88k5{top:50px;width:30px;height:30px;}.css-do88k5 .theme-icon{width:15px;height:15px;}}</style><div class="css-do88k5 e1gmrmu50"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" class="theme-icon"><path d="M2.89998 0.499976C2.89998 0.279062 2.72089 0.0999756 2.49998 0.0999756C2.27906 0.0999756 2.09998 0.279062 2.09998 0.499976V1.09998H1.49998C1.27906 1.09998 1.09998 1.27906 1.09998 1.49998C1.09998 1.72089 1.27906 1.89998 1.49998 1.89998H2.09998V2.49998C2.09998 2.72089 2.27906 2.89998 2.49998 2.89998C2.72089 2.89998 2.89998 2.72089 2.89998 2.49998V1.89998H3.49998C3.72089 1.89998 3.89998 1.72089 3.89998 1.49998C3.89998 1.27906 3.72089 1.09998 3.49998 1.09998H2.89998V0.499976ZM5.89998 3.49998C5.89998 3.27906 5.72089 3.09998 5.49998 3.09998C5.27906 3.09998 5.09998 3.27906 5.09998 3.49998V4.09998H4.49998C4.27906 4.09998 4.09998 4.27906 4.09998 4.49998C4.09998 4.72089 4.27906 4.89998 4.49998 4.89998H5.09998V5.49998C5.09998 5.72089 5.27906 5.89998 5.49998 5.89998C5.72089 5.89998 5.89998 5.72089 5.89998 5.49998V4.89998H6.49998C6.72089 4.89998 6.89998 4.72089 6.89998 4.49998C6.89998 4.27906 6.72089 4.09998 6.49998 4.09998H5.89998V3.49998ZM1.89998 6.49998C1.89998 6.27906 1.72089 6.09998 1.49998 6.09998C1.27906 6.09998 1.09998 6.27906 1.09998 6.49998V7.09998H0.499976C0.279062 7.09998 0.0999756 7.27906 0.0999756 7.49998C0.0999756 7.72089 0.279062 7.89998 0.499976 7.89998H1.09998V8.49998C1.09998 8.72089 1.27906 8.89997 1.49998 8.89997C1.72089 8.89997 1.89998 8.72089 1.89998 8.49998V7.89998H2.49998C2.72089 7.89998 2.89998 7.72089 2.89998 7.49998C2.89998 7.27906 2.72089 7.09998 2.49998 7.09998H1.89998V6.49998ZM8.54406 0.98184L8.24618 0.941586C8.03275 0.917676 7.90692 1.1655 8.02936 1.34194C8.17013 1.54479 8.29981 1.75592 8.41754 1.97445C8.91878 2.90485 9.20322 3.96932 9.20322 5.10022C9.20322 8.37201 6.82247 11.0878 3.69887 11.6097C3.45736 11.65 3.20988 11.6772 2.96008 11.6906C2.74563 11.702 2.62729 11.9535 2.77721 12.1072C2.84551 12.1773 2.91535 12.2458 2.98667 12.3128L3.05883 12.3795L3.31883 12.6045L3.50684 12.7532L3.62796 12.8433L3.81491 12.9742L3.99079 13.089C4.11175 13.1651 4.23536 13.2375 4.36157 13.3059L4.62496 13.4412L4.88553 13.5607L5.18837 13.6828L5.43169 13.7686C5.56564 13.8128 5.70149 13.8529 5.83857 13.8885C5.94262 13.9155 6.04767 13.9401 6.15405 13.9622C6.27993 13.9883 6.40713 14.0109 6.53544 14.0298L6.85241 14.0685L7.11934 14.0892C7.24637 14.0965 7.37436 14.1002 7.50322 14.1002C11.1483 14.1002 14.1032 11.1453 14.1032 7.50023C14.1032 7.25044 14.0893 7.00389 14.0623 6.76131L14.0255 6.48407C13.991 6.26083 13.9453 6.04129 13.8891 5.82642C13.8213 5.56709 13.7382 5.31398 13.6409 5.06881L13.5279 4.80132L13.4507 4.63542L13.3766 4.48666C13.2178 4.17773 13.0353 3.88295 12.8312 3.60423L12.6782 3.40352L12.4793 3.16432L12.3157 2.98361L12.1961 2.85951L12.0355 2.70246L11.8134 2.50184L11.4925 2.24191L11.2483 2.06498L10.9562 1.87446L10.6346 1.68894L10.3073 1.52378L10.1938 1.47176L9.95488 1.3706L9.67791 1.2669L9.42566 1.1846L9.10075 1.09489L8.83599 1.03486L8.54406 0.98184ZM10.4032 5.30023C10.4032 4.27588 10.2002 3.29829 9.83244 2.40604C11.7623 3.28995 13.1032 5.23862 13.1032 7.50023C13.1032 10.593 10.596 13.1002 7.50322 13.1002C6.63646 13.1002 5.81597 12.9036 5.08355 12.5522C6.5419 12.0941 7.81081 11.2082 8.74322 10.0416C8.87963 10.2284 9.10028 10.3497 9.34928 10.3497C9.76349 10.3497 10.0993 10.0139 10.0993 9.59971C10.0993 9.24256 9.84965 8.94373 9.51535 8.86816C9.57741 8.75165 9.63653 8.63334 9.6926 8.51332C9.88358 8.63163 10.1088 8.69993 10.35 8.69993C11.0403 8.69993 11.6 8.14028 11.6 7.44993C11.6 6.75976 11.0406 6.20024 10.3505 6.19993C10.3853 5.90487 10.4032 5.60464 10.4032 5.30023Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></div><style data-emotion="css 1epef34">.css-1epef34{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;min-height:100vh;word-break:keep-all;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;padding:60px 15px;margin-bottom:61px;background-color:#FFFFFF;box-shadow:0 0 30px rgb(0 0 0 / 0.1);}@media screen and (max-width: 768px){.css-1epef34{margin-bottom:39px;padding-bottom:30px;}}</style><div class="css-1epef34 e1oc8ext1"><style data-emotion="css 1pxycuq">.css-1pxycuq{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;width:100%;height:60px;position:fixed;top:0;left:0;background-color:#FFFFFF;z-index:100;}@media screen and (max-width: 768px){.css-1pxycuq{padding:0 15px;}}</style><div class="css-1pxycuq ergyqlo3"><style data-emotion="css rac6g">.css-rac6g{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;width:100%;max-width:720px;font-family:GmarketSansBold;}@media screen and (max-width: 768px){.css-rac6g .mobile-logo{background-color:#0F1010;width:25px;height:25px;border-radius:50%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;font-family:Montserrat;font-weight:800;}.css-rac6g .mobile-logo a{color:#FFFFFF;}}</style><div class="css-rac6g ergyqlo2"><div><div class="pc-only"><style data-emotion="css 4azvcs">.css-4azvcs{font-size:17px;display:inline-block;position:relative;}.css-4azvcs:after{content:'';position:absolute;width:100%;-webkit-transform:scaleX(0);-moz-transform:scaleX(0);-ms-transform:scaleX(0);transform:scaleX(0);height:1px;bottom:-1px;left:0;background-color:#0F1010;transform-origin:bottom right;-webkit-transition:-webkit-transform 0.25s ease-out;transition:transform 0.25s ease-out;}.css-4azvcs:hover:after{-webkit-transform:scaleX(1);-moz-transform:scaleX(1);-ms-transform:scaleX(1);transform:scaleX(1);transform-origin:bottom left;}@media screen and (max-width: 768px){.css-4azvcs:hover:after{-webkit-transform:scaleX(0);-moz-transform:scaleX(0);-ms-transform:scaleX(0);transform:scaleX(0);}}.css-4azvcs:after{height:2px;bottom:-2px;-webkit-transform:scaleX(0);-moz-transform:scaleX(0);-ms-transform:scaleX(0);transform:scaleX(0);}@media screen and (max-width: 768px){.css-4azvcs:hover:after{-webkit-transform:scaleX(0);-moz-transform:scaleX(0);-ms-transform:scaleX(0);transform:scaleX(0);}}@media screen and (max-width: 768px){.css-4azvcs{font-size:13px;}}</style><a isselected="false" class="css-4azvcs ergyqlo0" href="/">swkicat</a></div><div class="mobile-only mobile-logo"><a isselected="false" class="css-4azvcs ergyqlo0" href="/">D</a></div></div><style data-emotion="css zatqba">.css-zatqba{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:10px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-zatqba ergyqlo1"><a isselected="false" class="css-4azvcs ergyqlo0" href="/posts">posts</a><a isselected="false" class="css-4azvcs ergyqlo0" href="/about">about</a></div></div></div><style data-emotion="css e6awp2">.css-e6awp2{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;width:100%;max-width:720px;}</style><main class="css-e6awp2 e1oc8ext0"><style data-emotion="css 1rjlvbj">.css-1rjlvbj{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;padding-bottom:40px;border-bottom:1px solid #EEEFF1;margin:40px 0;word-break:keep-all;}</style><header class="css-1rjlvbj e11ak9ox5"><style data-emotion="css 3muz7f">.css-3muz7f{font-size:78px;margin-bottom:20px;}</style><div class="css-3muz7f e11ak9ox4">🔮</div><style data-emotion="css o2o5ek">.css-o2o5ek{margin-bottom:5px;font-size:15px;}</style><div class="css-o2o5ek e11ak9ox2"><style data-emotion="css 1gdjc01">.css-1gdjc01{margin-right:4px;color:#989BA0;display:inline-block;position:relative;}.css-1gdjc01:after{content:'';position:absolute;width:100%;-webkit-transform:scaleX(0);-moz-transform:scaleX(0);-ms-transform:scaleX(0);transform:scaleX(0);height:1px;bottom:-1px;left:0;background-color:#0F1010;transform-origin:bottom right;-webkit-transition:-webkit-transform 0.25s ease-out;transition:transform 0.25s ease-out;}.css-1gdjc01:hover:after{-webkit-transform:scaleX(1);-moz-transform:scaleX(1);-ms-transform:scaleX(1);transform:scaleX(1);transform-origin:bottom left;}@media screen and (max-width: 768px){.css-1gdjc01:hover:after{-webkit-transform:scaleX(0);-moz-transform:scaleX(0);-ms-transform:scaleX(0);transform:scaleX(0);}}.css-1gdjc01:after{background-color:#989BA0;}</style><a class="css-1gdjc01 e11ak9ox1" href="/posts/Effective-kotlin">Effective-kotlin</a></div><style data-emotion="css 1xqnk3h">.css-1xqnk3h{font-size:32px;margin-bottom:6px;line-height:1.3;}@media screen and (max-width: 768px){.css-1xqnk3h{font-size:25px;}}</style><h1 class="css-1xqnk3h e11ak9ox0">item1-가변성을 제한하라</h1><style data-emotion="css dror6n">.css-dror6n{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:15px;color:#808388;font-family:GmarketSansLight;}</style><div class="css-dror6n e11ak9ox3">2023.08.20</div></header><style data-emotion="css 1ayc6q6">.css-1ayc6q6{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;width:100%;margin-bottom:30px;}</style><div class="css-1ayc6q6 e6ffem50"><div class="markdown"><div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">class</span> BankAccount <span class="token punctuation">{</span>
	<span class="token keyword">var</span> balance <span class="token operator">=</span> <span class="token number">0.0</span>
	<span class="token keyword">private</span> <span class="token keyword">set</span>

	<span class="token keyword">fun</span> <span class="token function">deposit</span><span class="token punctuation">(</span>depositAmount<span class="token operator">:</span> Double<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		balance <span class="token operator">+=</span> depositAmount
	<span class="token punctuation">}</span>
	
	<span class="token annotation builtin">@Throws</span><span class="token punctuation">(</span>InsufficientFunds<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span>
	<span class="token keyword">fun</span> <span class="token function">withdraw</span><span class="token punctuation">(</span>withdrawAmount<span class="token operator">:</span> Double<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>balance <span class="token operator">&lt;</span> withdrawAmount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token function">InsufficientFunds</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		balance <span class="token operator">-=</span> withdrawAmount
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> InsufficientFunds <span class="token operator">:</span> <span class="token function">Exception</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> account <span class="token operator">=</span> <span class="token function">BankAccount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">println</span><span class="token punctuation">(</span>account<span class="token punctuation">.</span>balance<span class="token punctuation">)</span> <span class="token comment">// 0.0</span>
account<span class="token punctuation">.</span><span class="token function">deposit</span><span class="token punctuation">(</span><span class="token number">100.0</span><span class="token punctuation">)</span>
<span class="token function">println</span><span class="token punctuation">(</span>account<span class="token punctuation">.</span>balance<span class="token punctuation">)</span> <span class="token comment">// 100.0</span>
account<span class="token punctuation">.</span><span class="token function">deposit</span><span class="token punctuation">(</span><span class="token number">50.0</span><span class="token punctuation">)</span>
<span class="token function">println</span><span class="token punctuation">(</span>account<span class="token punctuation">.</span>balance<span class="token punctuation">)</span> <span class="token comment">// 50.0</span></code></pre></div>
<p>본 책에 존재하는 코드는 BankAccount에는 계좌에 돈이 얼마나 있는지 나타내는 상태가 있다.<br>
위 코드가 작동 동작에 대해서는 문제가 없지만, 상태를 적절하게 관리하기 위해서는 어려움이 존재한다.</p>
<blockquote>
<p>상태를 관리하기 어려운 이유</p>
<ol>
<li>프로그램을 이해하고 디버그하는데 어려움이 존재한다.</li>
<li>가변성(mutability) 있으면, 코드의 실행을 추적하기 어려움이 존재한다.</li>
<li>멀티스레드 프로그램 상황에서 적절한 동기화가 필요하다.</li>
<li>테스트가 어렵다. 모든 상태를 테스트해야하기에 변경이 많아질수록 더 많은 조합을 테스트해야 한다.</li>
<li>상태 변경이 일어나면, 변경을 다른 부분에 알려야 한다. 정렬해야 하는 리스트에 새로운 가변 값이 추가되면, 리스트를 다시 정렬하라고 알려줘야 한다.</li>
</ol>
</blockquote>
<p>가변성은 생각보다 단점이 많아서 완전하게 제한하는 프로그래밍 언어가 있다. 가변성은 시스템의 상태를 나타내기 위한 중요한 방법이다. 하지만 변경이 일어나야 하는 부분은 신중, 확실하게 결정하고 사용해야 한다.</p>
<h2 id="코틀린에서-가변성-제한하기" style="position:relative;"><a href="#%EC%BD%94%ED%8B%80%EB%A6%B0%EC%97%90%EC%84%9C-%EA%B0%80%EB%B3%80%EC%84%B1-%EC%A0%9C%ED%95%9C%ED%95%98%EA%B8%B0" aria-label="코틀린에서 가변성 제한하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>코틀린에서 가변성 제한하기</h2>
<p>코틀린은 가변성을 제한할 수 있게 설계되어 있다.</p>
<ul>
<li>읽기 전용 프로퍼티(val)</li>
<li>가변 컬렉션과 읽기 전용 컬렉션 구분하기</li>
<li>데이터 클래스의 copy</li>
</ul>
<ol>
<li><strong>읽기 전용 프로퍼티(val)</strong></li>
</ol>
<ul>
<li>마치 값(value)처럼 동작하며, 일반적인 방법으로 값이 변하지 않는다.<br>
(읽고 쓸 수 있는 경우는 var 활용할 수 있다.)</li>
</ul>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> a <span class="token operator">=</span> <span class="token number">10</span>
a <span class="token operator">=</span> <span class="token number">20</span> <span class="token comment">// 오류</span></code></pre></div>
<ul>
<li>읽기 전용 프로퍼티가 완전히 변경 불가능한 것은 아니다. mutable 객체를 담고 있다면, 내부적으로 변할 수 있다.</li>
</ul>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> list <span class="token operator">=</span> <span class="token function">mutableListOf</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span> <span class="token comment">// [1, 2, 3, 4]</span></code></pre></div>
<ul>
<li>읽기 전용 프로퍼티는 다른 프로퍼티를 활용하는 사용자 정의 게터로도 정의가 가능하다.</li>
</ul>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">var</span> name<span class="token operator">:</span> String <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Marcin"</span></span>
<span class="token keyword">var</span> surname<span class="token operator">:</span> String <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Moskala"</span></span>
<span class="token keyword">val</span> fullName
	<span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">name</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">surname</span></span><span class="token string">"</span></span>

<span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">println</span><span class="token punctuation">(</span>fullName<span class="token punctuation">)</span> <span class="token comment">// Marcin Moskala</span>
	name <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Maja"</span></span>
	<span class="token function">println</span><span class="token punctuation">(</span>fullName<span class="token punctuation">)</span> <span class="token comment">// Maja Moskala</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>var은 게터와 세터를 모두 제공하지만, val은 변경이 불가능하므로 게터만 제공한다.<br>
그래서 val은 var로 오버로드 할 수 있다.</li>
</ul>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">interface</span> Element <span class="token punctuation">{</span>
    <span class="token keyword">var</span> active<span class="token operator">:</span> Boolean
<span class="token punctuation">}</span>

<span class="token keyword">class</span> ActualElement<span class="token operator">:</span> Element <span class="token punctuation">{</span>
    <span class="token keyword">override</span> <span class="token keyword">var</span> active<span class="token operator">:</span> Boolean <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>val은 정의 옆에 상태가 바로 적히기 때문에, 코드의 실행을 예측하는 것이 훨씬 간단하며, 스마트 캐스트 등의 추가적인 기능을 활용할 수 있다.</li>
<li>fullName은 게터로 정의했으므로 스마트 캐스트를 할 수 없다. 게터를 활용하므로, 값을 사용하는 시점의 name에 따라서 다른 결과가 나올 수 있기 때문이다.</li>
</ul>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> name<span class="token operator">:</span> String<span class="token operator">?</span> <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Marton"</span></span>
<span class="token keyword">val</span> surname<span class="token operator">:</span> String <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Braun"</span></span>

<span class="token keyword">val</span> fullName<span class="token operator">:</span> String<span class="token operator">?</span>
    <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> name<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">let</span> <span class="token punctuation">{</span> <span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">it</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">surname</span></span><span class="token string">"</span></span> <span class="token punctuation">}</span>

<span class="token keyword">val</span> fullName2<span class="token operator">:</span> String<span class="token operator">?</span> <span class="token operator">=</span> name<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">let</span> <span class="token punctuation">{</span> <span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">it</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">surname</span></span><span class="token string">"</span></span> <span class="token punctuation">}</span>

<span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>fullName <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">println</span><span class="token punctuation">(</span>fullName<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token comment">// 오류</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>fullName2 <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">println</span><span class="token punctuation">(</span>fullName2<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token comment">// 12</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<ol start="2">
<li><strong>가변 컬렉션과 읽기 전용 컬렉션 구분하기</strong></li>
</ol>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 76.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACd0lEQVQ4y42TDW/TMBCG9///EALBAE0IxthAW1faLk3Sj6Rp2nzHTmwnfZA9viYhwFJ0vov9+O78+izcS26Dirug5C6smIQVybHC3yu+biW3fuHscq8YxxN2nE6P9k/jbLquOf8UcPFlzdubFW8/b/BWCbNYc+1VvP4UcLUomMUGM4z/BlbCkLUngqggziRZO2JGyBtDUij8qCCtDFmtf4L+CkxLzTYfmAYZy51gmxlkPxDnmjDtuQ8yVgdNlCnG/wFeTjY8ezdzZb+89Hj+fsFkvuJ+23Nxu+PF+zkXtzGTTc/wPyXHuWIRS+ZRi7fr8JKethvYZIblXvMQS/zUsD7akh9hf/vOLFUKQZHnjINxpwxGo3pJ3wmyLEOp3vk2/ufxK2MHFFJSFAWNUPQGlqsd2yQnryRCSIpaOj/Y7OkMtJ1xEmq6AaFOdBo379TwFOjFgmlkuPEKJmvJPBlo5ICXaBe//Joy2SjmsaJqtZPS52Xl4va/bdcToO3XbDdy/ZBztxJuQ9E8AqaR5uPs4Kz1SwvcDXzxaz5MEzd/2P0GzPOcsukpxcCh7Mhqu8kwjCdqaSjbX3HrW5Hb/3mjOVY9RWtcKx6BQlBVNXVdojrBKgzIswOdbKmr6mfTj4cURvPkOrTq3Nofl+OATdOgtWZfGvxUMwkKFpFgnQ3sDwVhIggPmvsgx9/3bDPlxB+mmkXUMglygtSK/3vJUnauh/NI8OZmw4sPC86vfO7WHXN/y/VDwevrkPOPHq+ufKbbzrXGvnG71or/1VXAPO45+131SaHdSWGqCFLlspLKilyzTHq8nWSZdKyPCmEzPGiXpbV2vX0k3wCN9HTGRoByzQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="collection"
        title="collection"
        src="/static/44ba93469048eb3e80c7b468ac59ec25/37523/mutable-immutable-collections.png"
        srcset="/static/44ba93469048eb3e80c7b468ac59ec25/e9ff0/mutable-immutable-collections.png 180w,
/static/44ba93469048eb3e80c7b468ac59ec25/f21e7/mutable-immutable-collections.png 360w,
/static/44ba93469048eb3e80c7b468ac59ec25/37523/mutable-immutable-collections.png 720w,
/static/44ba93469048eb3e80c7b468ac59ec25/302a4/mutable-immutable-collections.png 1080w,
/static/44ba93469048eb3e80c7b468ac59ec25/a3767/mutable-immutable-collections.png 1210w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
<ul>
<li>읽기 전용 인터페이스 > Iterable, Collection, Set, List</li>
<li>읽고 쓸 수 있는 인터페이스 > MutableIterable, MutableCollection, MutableSet, MutableList</li>
<li><code class="language-text">Iterable&lt;T>.map</code>, <code class="language-text">Iterable&lt;T>.filter</code> 함수는 ArrayList를 리턴한다.
실질적으로 코틀린이 내부적으로 immutable하지 않은 컬렉션을 외부적으로 immutable하게 보이게 만들어서 얻어지는 안정성입니다.</li>
</ul>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">inline</span> <span class="token keyword">fun</span> <span class="token operator">&lt;</span>T<span class="token punctuation">,</span> R<span class="token operator">></span> Iterable<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token function">map</span><span class="token punctuation">(</span>
	transformation<span class="token operator">:</span> <span class="token punctuation">(</span>T<span class="token punctuation">)</span> <span class="token operator">-></span> R
<span class="token punctuation">)</span><span class="token operator">:</span> List<span class="token operator">&lt;</span>R<span class="token operator">></span> <span class="token punctuation">{</span>
	<span class="token keyword">val</span> list <span class="token operator">=</span> ArrayList<span class="token operator">&lt;</span>R<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>elem <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">transformation</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> list
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>컬렉션 다운캐스팅은 읽기 전용으로 리턴하였는데, 이를 읽기 전용으로만 사용하지 않는 계약을 위반하고, 추상화를 무시하는 행위이다. 이런 코드는 아전하지 않으며, 예측하지못한 결과를 초래한다.</li>
</ul>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> list <span class="token operator">=</span> <span class="token function">listOf</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment">// 이렇게 하지 마세요</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>list <span class="token keyword">is</span> MutableList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 이렇게 사용하세요</span>
<span class="token keyword">val</span> mutableList <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">toMutableList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
mutableList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span></code></pre></div>
<ol start="3">
<li>데이터 클래스의 copy</li>
</ol>
<ul>
<li>String과 Int처럼 immutable 객체 사용의 장점
<blockquote>
<ol>
<li>한 번 정의된 상태가 유지되므로, 코드를 이해하기 쉽다.</li>
<li>immutable 객체는 공유했을 때도 충돌이 따로 이루어지지 않으므로, 병렬 처리를 안전하게 할 수 있다.</li>
<li>immutable 객체 대한 참조는 변경되지 않으므로, 쉽게 캐시가 가능하다.</li>
<li>immutable 객체는 방어적 복사본(defensive copy)을 만들 필요가 없다. 또한 객체를 복사할 때 깊은 복사를 따로 하지 않아도 된다.</li>
<li>immutable 객체는 다른 객체를 만들 때 활용하기 좋다.</li>
<li>immutable 객체는 set, map의 키로 사용할 수 있다. mutable 객체는 이러한 것으로 사용할 수 없다. 내부적으로 해시 테이블을 사용하고 있고, 해시 테이블은 처음 요소를 넣을 떄 요소의 값을 기반으로 버킷을 결정하기 때문이다.</li>
</ol>
</blockquote>
</li>
</ul>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> names<span class="token operator">:</span> SortedSet<span class="token operator">&lt;</span>FullName<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">TreeSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> person <span class="token operator">=</span> <span class="token function">FullName</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"AAA"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"AAA"</span></span><span class="token punctuation">)</span>
names<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span>
names<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">FullName</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"BBB"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"BBB"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
names<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">FullName</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"CCC"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"CCC"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token function">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token comment">// [AAA AAA, BBB BBB, CCC CCC]</span>
<span class="token function">print</span><span class="token punctuation">(</span>person <span class="token keyword">in</span> names<span class="token punctuation">)</span> <span class="token comment">// true</span>

person<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"ZZZ"</span></span>
<span class="token function">print</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span> <span class="token comment">// [ZZZ AAA, BBB BBB, CCC CCC]</span>
<span class="token function">print</span><span class="token punctuation">(</span>person <span class="token keyword">in</span> names<span class="token punctuation">)</span> <span class="token comment">// false</span></code></pre></div>
<ul>
<li>mutable 객체는 예측하기 어려우며 위험하는 단점이 있다. 반면 immutable 객체는 변경할 수 없다는 단점이 있다. 따라서, immutable 객체는 자신의 일부를 수정한 새로운 객체를 만들어 내는 메서드가 필요로 하다.</li>
</ul>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">class</span> <span class="token function">User</span> <span class="token punctuation">(</span><span class="token keyword">val</span> name<span class="token operator">:</span>String<span class="token punctuation">,</span> <span class="token keyword">val</span> surname<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">fun</span> <span class="token function">withSurname</span><span class="token punctuation">(</span>surname<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">User</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> usrname<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"AAA"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"BBB"</span></span><span class="token punctuation">)</span>
user <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">withSurname</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"CCC"</span></span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token comment">// User(name="AAA", surname="CCC")</span></code></pre></div>
<ul>
<li>모든 프로퍼티를 대상으로 이런 함수를 하나하나 만들기 귀찮기 때문에, data 한정자를 사용하면 된다.</li>
</ul>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">User</span> <span class="token punctuation">(</span><span class="token keyword">val</span> name<span class="token operator">:</span>String<span class="token punctuation">,</span> <span class="token keyword">val</span> surname<span class="token operator">:</span> String<span class="token punctuation">)</span>

<span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"AAA"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"BBB"</span></span><span class="token punctuation">)</span>
user <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"CCC"</span></span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token comment">// User(name="AAA", surname="CCC")</span></code></pre></div>
<h2 id="다른-종류의-변경-가능-지점" style="position:relative;"><a href="#%EB%8B%A4%EB%A5%B8-%EC%A2%85%EB%A5%98%EC%9D%98-%EB%B3%80%EA%B2%BD-%EA%B0%80%EB%8A%A5-%EC%A7%80%EC%A0%90" aria-label="다른 종류의 변경 가능 지점 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>다른 종류의 변경 가능 지점</h2>
<p>변경할 수 있는 리스트를 만든다고 가정할 때, 2가지 선택지가 존재한다.</p>
<blockquote>
<p>mutable 컬렉션 만들기
var로 읽고 쓸 수 있는 프로퍼티 만들기</p>
</blockquote>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> list1<span class="token operator">:</span> MutableList<span class="token operator">&lt;</span>Int<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">mutableListOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> list2<span class="token operator">:</span> List<span class="token operator">&lt;</span>Int<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">listOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

list1<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
list2 <span class="token operator">=</span> list2 <span class="token operator">+</span> <span class="token number">1</span>

list1 <span class="token operator">+=</span> <span class="token number">1</span> <span class="token comment">// list1.plusAssign(1)로 변경된다.</span>
list2 <span class="token operator">+=</span> <span class="token number">1</span> <span class="token comment">// list2 = list2.plus(1)로 변경된다.</span></code></pre></div>
<p>전자의 경우 구체적인 리스트 구현 내부에 변경 가능 지점이 있어, 멀티스레드 처리가 이루어질 경우, 내부적으로 적절한 동기화가 되어 있는지 알 수 없어 위험한다.</p>
<p>후자의 경우 프로퍼티 자체가 변경 가능 지점이라 멀티스레드 처리의 안전성이 더 좋다.(잘못 만들면 일부 요소가 손실될 수도 있다.)</p>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">var</span> list <span class="token operator">=</span> listOf<span class="token operator">&lt;</span>Int<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">..</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		thread <span class="token punctuation">{</span>
		list <span class="token operator">=</span> list <span class="token operator">+</span> i
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span>size<span class="token punctuation">)</span> <span class="token comment">// 1~1000을 더한 값이 되지 않는다. 실행할 때마다 다른 숫자가 나온다</span></code></pre></div>
<p>mutable 리스트 대신 mutable 프로퍼티를 사용하는 형태는 사용자 정의 세터를 활용해서 변경을 추적할 수 있다.</p>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">var</span> names <span class="token keyword">by</span> Delegates<span class="token punctuation">.</span><span class="token function">observable</span><span class="token punctuation">(</span>listOf<span class="token operator">&lt;</span>String<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> _<span class="token punctuation">,</span> old<span class="token punctuation">,</span> new <span class="token operator">-></span> 
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Names changed from </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">old</span></span><span class="token string"> to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">new</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

names <span class="token operator">+=</span> <span class="token string-literal singleline"><span class="token string">"Fabio"</span></span> <span class="token comment">// Names changed from [] to [Fabio]</span>
names <span class="token operator">+=</span> <span class="token string-literal singleline"><span class="token string">"Bill"</span></span> <span class="token comment">// Names changed from [Fabio] to [Fabio, Bill]</span></code></pre></div>
<p>프로퍼티와 컬렉션을 모두 변경 가능한 지점으로 만드는 것은 <strong>최악</strong> 이다.</p>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token comment">// 이렇게 하지 마세요.</span>
<span class="token keyword">var</span> list3 <span class="token operator">=</span> mutableListOf<span class="token operator">&lt;</span>Int<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div>
<h2 id="변경-가능-지점-노출하지-말기" style="position:relative;"><a href="#%EB%B3%80%EA%B2%BD-%EA%B0%80%EB%8A%A5-%EC%A7%80%EC%A0%90-%EB%85%B8%EC%B6%9C%ED%95%98%EC%A7%80-%EB%A7%90%EA%B8%B0" aria-label="변경 가능 지점 노출하지 말기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>변경 가능 지점 노출하지 말기</h2>
<p>mutable 객체를 외부에 노출하는건 위험하다.</p>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token keyword">val</span> name<span class="token operator">:</span> String<span class="token punctuation">)</span> 

<span class="token keyword">class</span> UserRepository <span class="token punctuation">{</span>
	<span class="token keyword">private</span> <span class="token keyword">val</span> storedUsers<span class="token operator">:</span> MuatableMap<span class="token operator">&lt;</span>Int<span class="token punctuation">,</span> String<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">mutableMapOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">fun</span> <span class="token function">loadAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> MutableMap<span class="token operator">&lt;</span>Int<span class="token punctuation">,</span>String<span class="token operator">></span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> storedUsers
	<span class="token punctuation">}</span>

	<span class="token comment">//...</span>
<span class="token punctuation">}</span>

<span class="token comment">// loadAll을 사용해서 private</span>
<span class="token keyword">val</span> userRepository <span class="token operator">=</span> <span class="token function">UserRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">val</span> storedUsers <span class="token operator">=</span> userRepository<span class="token punctuation">.</span><span class="token function">loadAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
storedUsers<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Kirill"</span></span>
<span class="token comment">//...</span>

<span class="token function">print</span><span class="token punctuation">(</span>userRepository<span class="token punctuation">.</span><span class="token function">loadAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// {4=Kirill}</span></code></pre></div>
<p>이러한 코드는 돌발적인 수정이 일어날 때 위험하다. 위를 해결하기 위한 방법은 2가지가 존재한다.</p>
<ol>
<li>리턴되는 Mutable 객체를 복제(방어적 복제(defensive copying))<br>
이때 data 한정자로 만들어지는 copy 메서드 활용하면 좋다.</li>
</ol>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">class</span> UserHolder <span class="token punctuation">{</span>
	<span class="token keyword">private</span> <span class="token keyword">val</span> user<span class="token operator">:</span> <span class="token function">MutableUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">fun</span> <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> MutableUser <span class="token punctuation">{</span>
		<span class="token keyword">return</span> user<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

		<span class="token comment">//...</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<ol start="2">
<li>가변성을 제한 (추천)
컬렉션은 객체를 읽기 전용 슈퍼타입으로 업캐스팅 하여 가변성을 제한된다.</li>
</ol>
<div class="gatsby-highlight" data-language="kotlin"><pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">class</span> UserRepository <span class="token punctuation">{</span>
	<span class="token keyword">private</span> <span class="token keyword">val</span> storedUsers<span class="token operator">:</span> MuatableMap<span class="token operator">&lt;</span>Int<span class="token punctuation">,</span> String<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">mutableMapOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">fun</span> <span class="token function">loadAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Map<span class="token operator">&lt;</span>Int<span class="token punctuation">,</span>String<span class="token operator">></span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> storedUsers
	<span class="token punctuation">}</span>

	<span class="token comment">//...</span>
<span class="token punctuation">}</span></code></pre></div>
<h2 id="정리" style="position:relative;"><a href="#%EC%A0%95%EB%A6%AC" aria-label="정리 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>정리</h2>
<ul>
<li>var보다는 val을 사용하는 것이 좋다.</li>
<li>mutable 프로퍼티보다는 immutable 프로퍼티를 사용하는 것이 좋다.</li>
<li>mutable 객체와 클래스보다는 immutable 객체와 클래스를 사용하는 것이 좋다.</li>
<li>변경이 필요한 대상을 만들어야 한다면, immutable 데이터 클래스로 만들고 copy를 활용하는 것이 좋다.</li>
<li>컬렉션에 상태를 저장해야 한다면, mutable 컬렉션보다는 읽기 전용 컬렉션을 사용하는 것이 좋다.</li>
<li>변이 지점을 적절하게 설계하고, 불필요한 변이 지점은 만들지 않는 것이 좋다.</li>
<li>mutable 객체를 외부에 노출하지 않는 것이 좋다.</li>
</ul>
<div class="table-of-contents">
<ul>
<li><a href="#%EC%BD%94%ED%8B%80%EB%A6%B0%EC%97%90%EC%84%9C-%EA%B0%80%EB%B3%80%EC%84%B1-%EC%A0%9C%ED%95%9C%ED%95%98%EA%B8%B0">코틀린에서 가변성 제한하기</a></li>
<li><a href="#%EB%8B%A4%EB%A5%B8-%EC%A2%85%EB%A5%98%EC%9D%98-%EB%B3%80%EA%B2%BD-%EA%B0%80%EB%8A%A5-%EC%A7%80%EC%A0%90">다른 종류의 변경 가능 지점</a></li>
<li><a href="#%EB%B3%80%EA%B2%BD-%EA%B0%80%EB%8A%A5-%EC%A7%80%EC%A0%90-%EB%85%B8%EC%B6%9C%ED%95%98%EC%A7%80-%EB%A7%90%EA%B8%B0">변경 가능 지점 노출하지 말기</a></li>
<li><a href="#%EC%A0%95%EB%A6%AC">정리</a></li>
</ul>
</div></div></div><style data-emotion="css 1oigrb5">.css-1oigrb5{display:grid;width:100%;grid-template-columns:49.3% 49.3%;-webkit-column-gap:1.4%;column-gap:1.4%;}</style><div class="css-1oigrb5 ewt10t13"><div></div><div><style data-emotion="css 1qd0f5s">.css-1qd0f5s{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;background-color:#F7F8FA;border-radius:6px;padding:15px;height:105px;cursor:pointer;}.css-1qd0f5s:hover{background-color:#EEEFF1;}.css-1qd0f5s:hover .title{-webkit-text-decoration:underline;text-decoration:underline;}.css-1qd0f5s.prev{margin-right:auto;}.css-1qd0f5s.next{margin-left:auto;}</style><a class="next css-1qd0f5s ewt10t12" href="/compose-internal-1/"><style data-emotion="css f9vs07">.css-f9vs07{color:#989BA0;margin-bottom:10px;}</style><div class="css-f9vs07 ewt10t11">다음 글</div><style data-emotion="css 1u6ok19">.css-1u6ok19{font-size:16px;line-height:150%;overflow:hidden;text-overflow:ellipsis;word-break:break-word;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;}</style><div class="css-1u6ok19 ewt10t10">Compose Internal (1) - 기본 시스템 원리</div></a></div></div><style data-emotion="css 1ab8s7t">.css-1ab8s7t{margin:30px 0;}</style><div class="utterances css-1ab8s7t e11ijv650"></div></main></div><style data-emotion="css 11h7mx5">.css-11h7mx5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;height:62px;margin-top:auto;position:fixed;bottom:0;z-index:-1;background-color:#F7F8FA;font-family:GmarketSansLight;}@media screen and (max-width: 768px){.css-11h7mx5{font-size:13px;height:40px;}}</style><div class="css-11h7mx5 e19a7gm21"><style data-emotion="css b1vorm">.css-b1vorm{text-align:center;width:100%;max-width:720px;}</style><p class="css-b1vorm e19a7gm20">© <!-- -->2024<!-- --> powered by stitch</p></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/effective-kotlin-item-1/";window.___webpackCompilationHash="c847988c0c66dff44e15";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-f5d960a57f3a3637c7c8.js"],"app":["/app-523d3873831d5e074b62.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-b9a517528300521af681.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-1544742cf446f0106cab.js"],"component---src-pages-about-tsx":["/component---src-pages-about-tsx-36987f7bbec9b288d85c.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-a0f0ef9767995f739c22.js"],"component---src-pages-playground-tsx":["/component---src-pages-playground-tsx-00f0d6a7ad621f78c54f.js"],"component---src-templates-post-template-index-tsx":["/component---src-templates-post-template-index-tsx-c2352aa73de0f1a08c2a.js"],"component---src-templates-posts-template-index-tsx":["/component---src-templates-posts-template-index-tsx-48e86d43802d0377a410.js"]};/*]]>*/</script><script src="/polyfill-f5d960a57f3a3637c7c8.js" nomodule=""></script><script src="/app-523d3873831d5e074b62.js" async=""></script><script src="/framework-ee0784ccad9a5b1a0434.js" async=""></script><script src="/webpack-runtime-6aa09d23e069ebf3f9ca.js" async=""></script></body></html>